<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Student Introduction Evaluator</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>

<body>
    <div class="container">
        <header>
            <h1>üéì Student Introduction Evaluator</h1>
            <p class="subtitle">AI-Powered Speech Analysis Tool</p>

            <!-- Deployment Notice -->
            <div
                style="background: linear-gradient(135deg, #FFF3CD 0%, #FFF8E1 100%); border-left: 4px solid #FFA000; padding: 12px 16px; border-radius: 8px; margin: 16px 0; font-size: 0.9rem;">
                <strong>‚ÑπÔ∏è Deployment Note:</strong> This deployed version uses <strong>rule-based scoring</strong>
                (semantic analysis disabled to work on free hosting).
                <details style="margin-top: 8px; cursor: pointer;">
                    <summary style="font-weight: 600; color: #F57C00;">Why is semantic analysis disabled?</summary>
                    <div style="margin-top: 8px; padding-left: 12px; border-left: 2px solid #FFB74D;">
                        <p style="margin: 4px 0;"><strong>Reason:</strong> Semantic AI models (sentence-transformers +
                            PyTorch) require 4GB download and 1.5GB RAM, causing deployment timeouts on free hosting.
                        </p>
                        <p style="margin: 4px 0;"><strong>What you still get:</strong> All 5 evaluation criteria work
                            perfectly with rule-based scoring, grammar checking, and sentiment analysis!</p>
                        <p style="margin: 4px 0;"><strong>Local use:</strong> To enable semantic scoring locally, edit
                            <code>web_app.py</code> line 10: <code>use_semantic=True</code> and install:
                            <code>pip install sentence-transformers torch</code></p>
                    </div>
                </details>
            </div>
        </header>

        <div class="main-content">
            <!-- Input Section -->
            <section class="input-section">
                <h2>üìù Input Transcript</h2>

                <!-- File Upload Option -->
                <div class="form-group">
                    <label for="file-upload">üìé Upload Text File (Optional):</label>
                    <div class="file-upload-wrapper">
                        <input type="file" id="file-upload" accept=".txt,.doc,.docx" onchange="handleFileUpload(event)"
                            class="file-input">
                        <label for="file-upload" class="file-label">
                            <span class="file-icon">üìÅ</span>
                            <span id="file-name">Choose a file or drag & drop</span>
                        </label>
                    </div>
                </div>

                <!-- OR Separator -->
                <div class="separator">
                    <span>OR</span>
                </div>

                <div class="form-group">
                    <label for="transcript">‚úçÔ∏è Paste Transcript Here:</label>
                    <textarea id="transcript" placeholder="Enter the student's introduction here..."
                        rows="8"></textarea>
                </div>

                <div class="form-group">
                    <label for="duration">‚è±Ô∏è Duration (seconds):</label>
                    <input type="number" id="duration" placeholder="e.g., 52" min="1" value="52">
                </div>

                <div class="button-group">
                    <button onclick="loadSample()" class="btn btn-secondary">
                        üìã Load Sample
                    </button>
                    <button onclick="clearAll()" class="btn btn-secondary">
                        üóëÔ∏è Clear
                    </button>
                    <button onclick="evaluateTranscript()" class="btn btn-primary">
                        üöÄ Evaluate Now
                    </button>
                </div>
            </section>

            <!-- Results Section -->
            <section class="results-section" id="results-section" style="display: none;">
                <h2>üìä Evaluation Results</h2>

                <!-- Summary Card -->
                <div class="summary-card">
                    <div class="score-display">
                        <div class="final-score" id="final-score">--/100</div>
                        <div class="grade-badge" id="grade-badge">-</div>
                    </div>
                    <div class="metadata">
                        <div class="meta-item">
                            <span class="meta-label">Words:</span>
                            <span class="meta-value" id="word-count">--</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">WPM:</span>
                            <span class="meta-value" id="wpm">--</span>
                        </div>
                        <div class="meta-item">
                            <span class="meta-label">Sentences:</span>
                            <span class="meta-value" id="sentence-count">--</span>
                        </div>
                    </div>
                </div>

                <!-- Detailed Scores -->
                <div class="scores-grid">
                    <!-- Content & Structure -->
                    <div class="score-card">
                        <h3>üìù Content & Structure</h3>
                        <div class="score-bar">
                            <div class="score-fill" id="content-fill"></div>
                        </div>
                        <div class="score-details">
                            <span id="content-score">--/40</span>
                            <span id="content-percent" class="percentage">--%</span>
                        </div>
                        <div class="breakdown">
                            <div class="breakdown-item">
                                <span>Salutation:</span>
                                <span id="salutation-score">--/5</span>
                            </div>
                            <div class="breakdown-item">
                                <span>Keywords:</span>
                                <span id="keywords-score">--/30</span>
                            </div>
                            <div class="breakdown-item">
                                <span>Flow:</span>
                                <span id="flow-score">--/5</span>
                            </div>
                        </div>
                    </div>

                    <!-- Speech Rate -->
                    <div class="score-card">
                        <h3>‚ö° Speech Rate</h3>
                        <div class="score-bar">
                            <div class="score-fill" id="speech-fill"></div>
                        </div>
                        <div class="score-details">
                            <span id="speech-score">--/10</span>
                            <span id="speech-label" class="label">--</span>
                        </div>
                    </div>

                    <!-- Language & Grammar -->
                    <div class="score-card">
                        <h3>üìñ Language & Grammar</h3>
                        <div class="score-bar">
                            <div class="score-fill" id="grammar-fill"></div>
                        </div>
                        <div class="score-details">
                            <span id="grammar-score">--/20</span>
                            <span id="grammar-percent" class="percentage">--%</span>
                        </div>
                        <div class="breakdown">
                            <div class="breakdown-item">
                                <span>Grammar:</span>
                                <span id="grammar-subscore">--/10</span>
                            </div>
                            <div class="breakdown-item">
                                <span>Vocabulary:</span>
                                <span id="vocab-score">--/10</span>
                            </div>
                        </div>
                    </div>

                    <!-- Clarity -->
                    <div class="score-card">
                        <h3>‚ú® Clarity</h3>
                        <div class="score-bar">
                            <div class="score-fill" id="clarity-fill"></div>
                        </div>
                        <div class="score-details">
                            <span id="clarity-score">--/15</span>
                            <span id="filler-info" class="label">--</span>
                        </div>
                    </div>

                    <!-- Engagement -->
                    <div class="score-card">
                        <h3>üí´ Engagement</h3>
                        <div class="score-bar">
                            <div class="score-fill" id="engagement-fill"></div>
                        </div>
                        <div class="score-details">
                            <span id="engagement-score">--/15</span>
                            <span id="sentiment-label" class="label">--</span>
                        </div>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="action-buttons" style="margin-top: 24px; display: flex; gap: 12px; flex-wrap: wrap;">
                    <button onclick="downloadJSON()" class="btn btn-secondary">
                        üíæ Download JSON
                    </button>
                    <button onclick="exportPDF()" class="btn btn-secondary">
                        üìÑ Export PDF
                    </button>
                    <button onclick="shareResults()" class="btn btn-secondary">
                        üîó Share Link
                    </button>
                    <button onclick="evaluateAgain()" class="btn btn-primary">
                        üîÑ Evaluate Another
                    </button>
                </div>
            </section>

            <!-- Loading Spinner -->
            <div class="loading" id="loading" style="display: none;">
                <div class="spinner"></div>
                <p>Analyzing transcript...</p>
            </div>

            <!-- Error Message -->
            <div class="error-message" id="error-message" style="display: none;"></div>
        </div>

        <footer>
            <p>Built with ‚ù§Ô∏è for Nirmaan AI Case Study</p>
        </footer>
    </div>

    <script src="{{ url_for('static', filename='js/app.js') }}"></script>
    <script src="{{ url_for('static', filename='js/export.js') }}"></script>
</body>

</html>